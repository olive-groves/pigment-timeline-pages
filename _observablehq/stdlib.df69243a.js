var D=Object.defineProperty;var o=(t,e)=>D(t,"name",{value:e,configurable:!0});var f,m,I=Object.defineProperty,d=o((t,e)=>I(t,"name",{value:e,configurable:!0}),"o$2");const v=new Map;function b(t,e,r=location){const n=new URL(t,r).href;if(e==null)v.delete(n);else{const{path:a,mimeType:i,lastModified:s,size:y}=e,l=new g(new URL(a,r).href,t.split("/").pop(),i,s,y);return v.set(n,l),l}}o(b,"y"),d(b,"registerFile");function w(t,e=location){if(new.target!==void 0)throw new TypeError("FileAttachment is not a constructor");let r;typeof t=="object"&&t&&"name"in t&&(r=t,t=t.name);const n=v.get(new URL(t,e).href);if(n)return n;if(r)return b(t,r,e);throw new Error(`File not found: ${t}`)}o(w,"d$1"),d(w,"FileAttachment");async function c(t){const e=await fetch(await t.url());if(!e.ok)throw new Error(`Unable to load file: ${t.name}`);return e}o(c,"n"),d(c,"remote_fetch");const j=(f=class{constructor(e,r="application/octet-stream",n,a){Object.defineProperties(this,{name:{value:`${e}`,enumerable:!0},mimeType:{value:`${r}`,enumerable:!0},lastModified:{value:+n,enumerable:!0},size:{value:+a,enumerable:!0}})}async blob(){return(await c(this)).blob()}async arrayBuffer(){return(await c(this)).arrayBuffer()}async text(e){return e===void 0?(await c(this)).text():new TextDecoder(e).decode(await this.arrayBuffer())}async json(){return(await c(this)).json()}async stream(){return(await c(this)).body}async dsv({delimiter:e=",",array:r=!1,typed:n=!1}={}){const[a,i]=await Promise.all([this.text(),import("../_npm/d3-dsv@3.0.1/407f7a1f.js")]),s=i.dsvFormat(e);return(r?s.parseRows:s.parse)(a,n&&i.autoType)}async csv(e){return this.dsv({...e,delimiter:","})}async tsv(e){return this.dsv({...e,delimiter:"	"})}async image(e){const r=await this.url();return new Promise((n,a)=>{const i=new Image;new URL(r,document.baseURI).origin!==new URL(location).origin&&(i.crossOrigin="anonymous"),Object.assign(i,e),i.onload=()=>n(i),i.onerror=()=>a(new Error(`Unable to load file: ${this.name}`)),i.src=r})}async arrow(){const[e,r]=await Promise.all([import("../_npm/apache-arrow@16.0.0/_esm.js"),c(this)]);return e.tableFromIPC(r)}async arquero(e){let r,n;switch(this.mimeType){case"application/json":r=this.text(),n="fromJSON";break;case"text/tab-separated-values":e?.delimiter===void 0&&(e={...e,delimiter:"	"});case"text/csv":r=this.text(),n="fromCSV";break;default:if(/\.arrow$/i.test(this.name))r=this.arrow(),n="fromArrow";else if(/\.parquet$/i.test(this.name))r=this.parquet(),n="fromArrow";else throw new Error(`unable to determine Arquero loader: ${this.name}`);break}const[a,i]=await Promise.all([import("../_npm/arquero@5.4.0/_esm.js"),r]);return a[n](i,e)}async parquet(){const[e,r,n]=await Promise.all([import("../_npm/apache-arrow@16.0.0/_esm.js"),import("../_npm/parquet-wasm@0.6.1/_esm.js").then(async a=>(await a.default(import.meta.resolve("../_npm/parquet-wasm@0.6.1/esm/parquet_wasm_bg.wasm")),a)),this.arrayBuffer()]);return e.tableFromIPC(r.readParquet(new Uint8Array(n)).intoIPCStream())}async sqlite(){const[{SQLiteDatabaseClient:e},r]=await Promise.all([import("./stdlib/sqlite.js"),this.arrayBuffer()]);return e.open(r)}async zip(){const[{ZipArchive:e},r]=await Promise.all([import("./stdlib/zip.js"),this.arrayBuffer()]);return e.from(r)}async xml(e="application/xml"){return new DOMParser().parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[{Workbook:e},r]=await Promise.all([import("./stdlib/xlsx.js"),this.arrayBuffer()]);return e.load(r)}},o(f,"m"),f);d(j,"AbstractFile");let x=j;const k=(m=class extends x{constructor(e,r,n,a,i){super(r,n,a,i),Object.defineProperty(this,"href",{value:e})}async url(){return this.href}},o(m,"w"),m);d(k,"FileAttachmentImpl");let g=k;Object.defineProperty(g,"name",{value:"FileAttachment"}),w.prototype=g.prototype;var S=Object.defineProperty,_=o((t,e)=>S(t,"name",{value:e,configurable:!0}),"r$2");async function*u(t){let e,r,n=!1;const a=t(i=>(r=i,e?(e(i),e=null):n=!0,i));if(a!=null&&typeof a!="function")throw new Error(typeof a.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");try{for(;;)yield n?(n=!1,r):new Promise(i=>e=i)}finally{a?.()}}o(u,"u"),_(u,"observe");var N=Object.defineProperty,E=o((t,e)=>N(t,"name",{value:e,configurable:!0}),"i$4");function A(){return u(t=>{let e;const r=matchMedia("(prefers-color-scheme: dark)"),n=document.createElement("div");n.style.transitionProperty="color, background-color",n.style.transitionDuration="1ms";const a=E(()=>{const i=getComputedStyle(document.body).getPropertyValue("color-scheme").split(/\s+/);let s;i.includes("light")&&i.includes("dark")?s=r.matches:s=i.includes("dark"),e!==s&&t(e=s)},"changed");return document.body.appendChild(n),a(),n.addEventListener("transitionstart",a),r.addEventListener("change",a),()=>{n.removeEventListener("transitionstart",a),r.removeEventListener("change",a)}})}o(A,"l$1"),E(A,"dark");var V=Object.defineProperty,h=o((t,e)=>V(t,"name",{value:e,configurable:!0}),"e$1");function F(t){return u(e=>{const r=z(t);let n=P(t);const a=h(()=>e(P(t)),"inputted");return t.addEventListener(r,a),n!==void 0&&e(n),()=>t.removeEventListener(r,a)})}o(F,"o$1"),h(F,"input");function P(t){switch(t.type){case"range":case"number":return t.valueAsNumber;case"date":return t.valueAsDate;case"checkbox":return t.checked;case"file":return t.multiple?t.files:t.files[0];case"select-multiple":return Array.from(t.selectedOptions,e=>e.value);default:return t.value}}o(P,"a"),h(P,"valueof");function z(t){switch(t.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}o(z,"f$2"),h(z,"eventof");var G=Object.defineProperty,J=o((t,e)=>G(t,"name",{value:e,configurable:!0}),"e");async function*L(){for(;;)yield Date.now()}o(L,"i$2"),J(L,"now");var Q=Object.defineProperty,W=o((t,e)=>Q(t,"name",{value:e,configurable:!0}),"r$1");async function*q(t){let e;const r=[],n=t(a=>(r.push(a),e&&(e(r.shift()),e=null),a));if(n!=null&&typeof n!="function")throw new Error(typeof n.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");try{for(;;)yield r.length?r.shift():new Promise(a=>e=a)}finally{n?.()}}o(q,"l"),W(q,"queue");var Z=Object.defineProperty,H=o((t,e)=>Z(t,"name",{value:e,configurable:!0}),"i$1");function R(t,e){return u(r=>{let n;const a=new ResizeObserver(([i])=>{const s=i.contentRect.width;s!==n&&r(n=s)});return a.observe(t,e),()=>a.disconnect()})}o(R,"d"),H(R,"width");var K=Object.freeze({__proto__:null,dark:A,input:F,now:L,observe:u,queue:q,width:R}),X=Object.defineProperty,$=o((t,e)=>X(t,"name",{value:e,configurable:!0}),"o");function C(t){let e;return Object.defineProperty(u(r=>{e=r,t!==void 0&&e(t)}),"value",{get:$(()=>t,"get"),set:$(r=>void e(t=r),"set")})}o(C,"f$1"),$(C,"Mutable");var Y=Object.defineProperty,U=o((t,e)=>Y(t,"name",{value:e,configurable:!0}),"r");function B(t,e){const r=document.createElement("div");r.style.position="relative",t.length!==1&&(r.style.height="100%");let n=0,a=0,i;const s=new ResizeObserver(async([y])=>{const{width:l,height:T}=y.contentRect;if(t.length===1&&l===i)return;i=l;const O=++n,p=l>0?await t(l,T):null;if(!(a>O)){for(a=O;r.lastChild;)r.lastChild.remove();p!=null&&(t.length!==1&&M(p)&&(p.style.position="absolute"),r.append(p))}});return s.observe(r),e?.then(()=>s.disconnect()),r}o(B,"p"),U(B,"resize");function M(t){return typeof t=="object"&&t.nodeType===1}o(M,"v"),U(M,"isElement");export{x as AbstractFile,w as FileAttachment,K as Generators,C as Mutable,b as registerFile,B as resize};
